<div class="container-event">
    <div class="content-event">
        <div class="content-top"><span>13:30</span></div>
        <div class="content-mid">
            <div class="img" style="background-image: url('{{event.img}}')">
                <div class="overlay">
                    <div class="team">
                        <div class="left">
                            <div class="team-name" style="color: {{event.team1.color}}">
                                <span>{{event.team1.name}}</span>
                            </div>
                            <div class="logo-team"><img src="{{event.team1.logo}}" alt=""></div>
                        </div>
                        <div class="right">
                            <div class="logo-team"><img src="{{event.team2.logo}}" alt=""></div>
                            <div class="team-name" style="color: {{event.team2.color}}">
                                <span>{{event.team2.name}}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="content-bottom" style="font-family: 'Oswald', sans-serif;">
            <div class="title">{{tournament._id}}</div>
            <div class="round">{{event.competition_format}}</div>
        </div>
    </div>
    <a href="#" id="open-modal" class="button">Đặt vé</a>
    <div class="info">
        <p>Thông tin :</p>
        <p>Nơi diễn ra : {{ tournament.venue }}, {{tournament.arena}}</p>
        <p>Thời gian diễn ra : {{ event.time }}</p>
        <p>Địa điểm : {{ tournament.district }}, {{ tournament.province }}, {{ tournament.city }},
            {{tournament.country}}</p>
    </div>
</div>


<div id="modal" class="modal" data-slug="{{event.slug}}" style="display: none">
    <div class="container-ticket">
        <div class="ticket-wrapper">
            <div class="ticket-banner">

                {{#each ticketStocks}}
                {{#if (eq this.type "master")}}
                <div id="master-ticket-banner">
                    <div class="ticket-content">
                        <p>Vé Cao Thủ :</p>
                        <p>Giá : {{this.price}}đ</p>
                        <p>Trạng Thái :
                            {{#if (gt this.remaining 0)}}
                            Còn {{this.remaining}} vé
                            {{else}}
                            Hết Vé
                            {{/if}}
                        </p>
                        {{#if (gt this.remaining 0)}}
                        <form method="POST" action="/ticket/buy">
                            <input type="hidden" name="ticketStockId" value="{{this._id}}">
                            <button type="submit" class="btn-master-ticket">Đặt vé</button>
                        </form>
                        {{else}}
                        <button class="btn-master-ticket" disabled>Hết vé</button>
                        {{/if}}
                    </div>
                </div>
                {{/if}}

                {{#if (eq this.type "challenge")}}
                <div id="challenge-ticket-banner">
                    <div class="ticket-content">
                        <p>Vé Thách Đấu :</p>
                        <p>Giá : {{this.price}}đ</p>
                        <p>Các vé quay thưởng skin</p>
                        <p>Trạng Thái :
                            {{#if (gt this.remaining 0)}}
                            Còn {{this.remaining}} vé
                            {{else}}
                            Hết Vé
                            {{/if}}
                        </p>
                        {{#if (gt this.remaining 0)}}
                        <form method="POST" action="/ticket/buy">
                            <input type="hidden" name="ticketStockId" value="{{this._id}}">
                            <button type="submit" class="btn-challenger-ticket">Đặt vé</button>
                        </form>
                        {{else}}
                        <button class="btn-challenger-ticket" disabled>Hết vé</button>
                        {{/if}}
                    </div>
                </div>
                {{/if}}

                {{#if (eq this.type "grandmaster")}}
                <div id="grandmaster-ticket-banner">
                    <div class="ticket-content">
                        <p>Vé Đại Cao Thủ :</p>
                        <p>Giá : {{this.price}}đ</p>
                        <p>Các vé quay thưởng skin</p>
                        <p>Trạng Thái :
                            {{#if (gt this.remaining 0)}}
                            Còn {{this.remaining}} vé
                            {{else}}
                            Hết Vé
                            {{/if}}
                        </p>
                        {{#if (gt this.remaining 0)}}
                        <form method="POST" action="/ticket/buy">
                            <input type="hidden" name="ticketStockId" value="{{this._id}}">
                            <button type="submit" class="btn-grandmaster-ticket">Đặt vé</button>
                        </form>
                        {{else}}
                        <button class="btn-grandmaster-ticket" disabled>Hết vé</button>
                        {{/if}}
                    </div>
                </div>
                {{/if}}
                {{/each}}

            </div>

            <div class="ticket-rank">
                <div id="master-ticket-rank"></div>
                <div id="grandmaster-ticket-rank"></div>
                <div id="challenge-ticket-rank"></div>
            </div>
        </div>
    </div>
</div>

<script>
    const modal = document.getElementById('modal')

    document.getElementById('open-modal').addEventListener('click', (e) => {
        e.preventDefault();
        modal.style.display = 'flex'
    });

    document.getElementById('close-modal')?.addEventListener('click', () => {
        modal.style.display = 'none'
    });

    window.onclick = (e) => {
        if (e.target == modal) {
            modal.style.display = 'none'
        }
    }
</script>


<div class="flash-container">
    {{#if success_msg}}
    <div class="flash-message success">{{success_msg}}</div>
    {{/if}}
    {{#if error_msg}}
    <div class="flash-message error">{{error_msg}}</div>
    {{/if}}
</div>